# 자바 소스 파일(.java)을 JVM으로 실행하는 과정 이해하기

## 학습할 것

- JVM이란 무엇인가
- 컴파일하는 방법
- 실행하는 방법
- 바이트코드란 무엇인가
- JIT 컴파일러란 무엇이며 어떻게 동작하는지
- JVM 구성 요소
- JDK와 JRE의 차이
  
&nbsp;   



---   
## JVM이란 무엇인가

JVM(Java Virtual Machine)은 **자바 가상 머신**을 의미하며, 자바 프로그램을 실행하기 위한 가상의 컴퓨터입니다. <br>
이 가상 머신은 실제 하드웨어가 아닌 소프트웨어로 구현되어 있으며, 운영체제에 관계없이 자바 프로그램을 실행할 수 있게 해줍니다.<br>
자바로 작성된 모든 프로그램은 JVM에서만 실행되므로, 자바는 "Write Once, Run Anywhere"라는 특성을 가집니다.<br>

&nbsp;   
---

## 컴파일하는 방법

컴파일은 소스 코드를 기계어(바이트코드)로 변환하는 과정입니다. <br>
자바에서는 `javac`라는 명령어를 사용하여 `.java` 파일을 `.class` 확장자를 가진 바이트코드 파일로 변환합니다.

### 예시:

```bash
javac hello.java

```

위 명령어를 실행하면 `hello.java` 소스 파일이 `hello.class`라는 바이트코드 파일로 컴파일됩니다. <br>
이 바이트코드는 JVM이 실행할 수 있는 반기계어입니다.

&nbsp;   
---

## 실행하는 방법

컴파일된 클래스 파일을 실행하려면 `java` 명령어를 사용합니다. <br>
이때 클래스 파일의 확장자는 생략하고, 메인 메서드가 포함된 클래스를 지정하면 됩니다. <br>
추가로 매개변수를 `String[] args` 형식으로 전달할 수 있습니다.

### 예시:

```bash
java hello

```

이 명령어는 `hello.class` 파일을 JVM에서 실행하여, `hello` 클래스의 `main` 메서드를 호출합니다.

&nbsp;   
---
## 바이트코드란 무엇인가

자바 바이트코드는 자바 소스 코드가 컴파일된 후, JVM이 이해할 수 있는 반기계어입니다. <br>
바이트코드는 기계어와 유사하지만, 운영체제와 하드웨어에 독립적인 형식으로 만들어집니다. <br>
바이트코드는 JVM이 실행할 수 있도록 해석될 때 기계어로 변환됩니다.<br>
이 바이트코드는 1바이트 크기의 명령어 단위로 처리됩니다.

&nbsp;   
---
## JIT 컴파일러란 무엇이며 어떻게 동작하는가

JIT(Just-In-Time) 컴파일러는 바이트코드를 실시간으로 기계어로 변환하는 컴파일러입니다. <br>
바이트코드는 처음에는 인터프리터를 통해 한 줄씩 실행되지만,<br>
반복적으로 호출되는 메서드는 JIT 컴파일러에 의해 기계어로 변환되어 더 빠르게 실행됩니다. <br>
이 방식은 **동적 번역**(Dynamic Translation)이라고도 부르며, 코드의 재사용을 최적화하여 성능을 향상시킵니다.

### 동작 방식:

1. **인터프리터**: 바이트코드를 한 줄씩 읽어 해석하고 실행합니다. 
2. **JIT 컴파일러**: 반복적으로 호출되는 메서드를 기계어로 변환하여, 이후 실행 시 빠르게 실행할 수 있도록 합니다.

&nbsp;   
---
## JVM 구성 요소

JVM은 **실행 엔진(Execution Engine)**과 **런타임 데이터 영역(Runtime Data Area)**, **클래스 로더(Class Loader)**로 구성됩니다.

### 1. 클래스 로더 (Class Loader)

클래스 로더는 JVM에 클래스 파일을 로드하는 역할을 합니다. <br>
자바는 **동적 로딩**(dynamic loading) 방식을 사용하여, 필요한 클래스만 로딩합니다. <br>
클래스 로더는 다음 세 가지 과정을 거칩니다:

- **로딩**: 클래스 정보를 메모리에 로딩합니다.
- **링킹**: 바이트코드가 적절한지 검사하고, 정적 변수들을 메모리에 할당합니다.
- **초기화**: 정적 변수를 초기화하고, `static` 블록을 실행합니다.

### 2. 런타임 데이터 영역 (Runtime Data Area)

- **메소드 영역**: 클래스 레벨의 데이터, 정적 변수(static 변수)들이 저장됩니다. 모든 스레드에서 공유됩니다.
- **힙 영역**: 생성된 객체와 배열이 저장됩니다. 이 영역도 JVM에서 하나만 존재하며, 객체가 공유됩니다.
- **스택 영역**: 메서드 호출 시 해당 메서드의 정보가 저장되는 영역입니다. 스레드마다 독립적으로 존재하며, 메서드가 실행될 때 지역 변수, 매개변수, 리턴 값 등이 저장됩니다.
- **PC 레지스터**: JVM 명령의 주소값을 저장합니다. 각 스레드마다 생성됩니다.

### 3. 실행 엔진 (Execution Engine)

실행 엔진은 바이트코드를 해석하고 실행하는 역할을 합니다.

- **인터프리터**: 바이트코드를 한 줄씩 읽어 해석합니다.
- **JIT 컴파일러**: 반복적으로 호출되는 메서드는 바이트코드를 기계어로 변환하여 성능을 최적화합니다.
- **Garbage Collector**: 사용되지 않는 객체를 메모리에서 제거합니다.

&nbsp;   
---
## JDK와 JRE의 차이

- **JDK**(Java Development Kit)는 자바 개발 도구로, 자바 애플리케이션을 개발하는 데 필요한 모든 도구를 포함하고 있습니다. <br>
    JDK에는 **JRE**가 포함되어 있으며, 자바 컴파일러인 `javac`와 같은 개발 도구도 제공됩니다.
- **JRE**(Java Runtime Environment)는 자바 애플리케이션을 실행하기 위한 환경으로, JVM과 클래스 라이브러리 등을 포함합니다.<br>
    JDK 없이도 자바 애플리케이션을 실행할 수 있지만, 개발은 불가능합니다.

### 차이점

- **JDK**: 자바 개발을 위한 도구 포함 (JRE 포함)
- **JRE**: 자바 애플리케이션 실행을 위한 환경

&nbsp;   
---
이제 자바 소스 코드가 어떻게 JVM에서 실행되는지, 각 과정에 대해 충분히 이해할 수 있습니다.<br>
각 단계마다 역할이 구체적이고, 최적화 기법(JIT)도 성능 향상에 중요한 역할을 한다는 점을 알 수 있습니다.
